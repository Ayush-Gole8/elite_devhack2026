{
  "title": "Remove the Grail Tree",
  "slug": "cf-2193-H",
  "difficulty": "Hard",
  "tags": [
    "dfs and similar",
    "dp",
    "graphs",
    "greedy",
    "implementation",
    "trees"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "The Great Grail Tree has stood in the kingdom for \n315\n315\n years. It takes up a lot of space, so King Ila decided to get rid of it as soon as possible. The tree itself is an acyclic, connected, undirected graph with \nğ‘›\nğ‘›\n vertices, each having its own value \nğ‘\nğ‘£\nğ‘\nğ‘£\n. The tree can be removed in the following way:\n\nLet \nğ‘†\nğ‘£\nğ‘†\nğ‘£\n be the sum of the values of all remaining neighbors of \nğ‘£\nğ‘£\n. If \nğ‘£\nğ‘£\n has no remaining neighbors, then \nğ‘†\nğ‘£\nğ‘†\nğ‘£\n is \n0\n0\n. Choose a vertex \nğ‘£\nğ‘£\n such that \nğ‘\nğ‘£\nğ‘\nğ‘£\n and \nğ‘†\nğ‘£\nğ‘†\nğ‘£\n differ in parity (i.e., either \nğ‘\nğ‘£\nğ‘\nğ‘£\n is even and \nğ‘†\nğ‘£\nğ‘†\nğ‘£\n is odd, or \nğ‘\nğ‘£\nğ‘\nğ‘£\n is odd and \nğ‘†\nğ‘£\nğ‘†\nğ‘£\n is even). If there are no such vertices, stop the process.\nRemove vertex \nğ‘£\nğ‘£\n and all edges connected to it from the tree.\nYour task is to determine whether there exists a sequence of removals that will lead to the complete removal of the Grail Tree (i.e., no vertices will remain in the tree). If such a sequence exists, output the sequence of \nğ‘›\nğ‘›\n vertices in the order of their removal. If there are multiple answers, output any of them.",
  "input_format": "Input\n\nEach test consists of several test case. The first line contains one integer \nğ‘¡\nğ‘¡\n (\n1â‰¤ğ‘¡â‰¤\n10\n4\n1\nâ‰¤\nğ‘¡\nâ‰¤\n10\n4\n) â€” the number of test cases. The description of the test cases follows.\n\nThe first line contains the number \nğ‘›\nğ‘›\n (\n1â‰¤ğ‘›â‰¤2â‹…\n10\n5\n1\nâ‰¤\nğ‘›\nâ‰¤\n2\nâ‹…\n10\n5\n) â€” the number of vertices in the Grail Tree.\n\nThe second line describes the array \nğ‘\nğ‘\n (\n1â‰¤\nğ‘\nğ‘–\nâ‰¤\n10\n9\n1\nâ‰¤\nğ‘\nğ‘–\nâ‰¤\n10\n9\n) â€” the values of the vertices in the tree.\n\nNext, there are \nğ‘›âˆ’1\nğ‘›\nâˆ’\n1\n lines, each containing 2 numbers \nğ‘£\nğ‘£\n and \nğ‘¢\nğ‘¢\n (\n1â‰¤ğ‘£,ğ‘¢â‰¤ğ‘›,ğ‘£â‰ ğ‘¢\n1\nâ‰¤\nğ‘£\n,\nğ‘¢\nâ‰¤\nğ‘›\n,\nğ‘£\nâ‰ \nğ‘¢\n), indicating that vertices \nğ‘£\nğ‘£\n and \nğ‘¢\nğ‘¢\n are connected by an edge in the tree.\n\nIt is guaranteed that the sum of \nğ‘›\nğ‘›\n across all test cases does not exceed \n2â‹…\n10\n5\n2\nâ‹…\n10\n5\n.",
  "output_format": "Output\n\nFor each test case, output \"YES\" if it is possible to completely remove the Grail Tree. Otherwise, output \"NO\". If the answer is \"YES\", output any sequence of removals.\n\nYou can output each letter in any case (lowercase or uppercase). For example, the strings \"yEs\", \"yes\", \"Yes\", and \"YES\" will be accepted as a positive answer.",
  "constraints": "",
  "test_cases": [
    {
      "input": "5\n3\n1 2 4\n1 2\n2 3\n4\n3 4 2 1\n1 2\n2 3\n3 4\n6\n9 6 5 1 7 4\n1 2\n2 3\n2 4\n3 5\n4 6\n5\n2 1 1 1 2\n2 1\n3 2\n2 4\n5 4\n5\n1 5 3 7 9\n1 2\n2 3\n3 4\n4 5",
      "output": "NO\nYES\n2 3 1 4 \nNO\nYES\n1 5 2 3 4 \nYES\n2 4 1 5 3",
      "is_sample": true
    }
  ]
}
