{
  "title": "Prufer Vertex",
  "slug": "cf-2190-D",
  "difficulty": "Hard",
  "tags": [
    "combinatorics",
    "dsu",
    "number theory",
    "probabilities",
    "trees"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "For a tree \nğ‘‡\nğ‘‡\n with \nğ‘›â‰¥2\nğ‘›\nâ‰¥\n2\n vertices, consider the standard process for generating its Prufer sequence. We repeatedly perform the following steps until only two vertices remain:\n\nSelect the leaf with the smallest label;\nRemove it from the tree.\n\nIt is known that vertex \nğ‘›\nğ‘›\n is always one of the two remaining vertices. Let \nğ‘£\nğ‘£\n be the other remaining vertex. We define the Prufer vertex of \nğ‘‡\nğ‘‡\n as \nğ‘ƒ(ğ‘‡)=ğ‘£\nğ‘ƒ\n(\nğ‘‡\n)\n=\nğ‘£\n.\n\nYou are given a forest with \nğ‘›\nğ‘›\n vertices and \nğ‘š\nğ‘š\n edges. Let \nğ‘˜\nğ‘˜\n be the number of connected components in this forest, and let their sizes be \nğ‘ \n1\n,\nğ‘ \n2\n,â€¦,\nğ‘ \nğ‘˜\nğ‘ \n1\n,\nğ‘ \n2\n,\nâ€¦\n,\nğ‘ \nğ‘˜\n. It is known that there are exactly \nğ‘›\nğ‘˜âˆ’2\nâˆ\nğ‘–=1\nğ‘˜\nğ‘ \nğ‘–\nğ‘›\nğ‘˜\nâˆ’\n2\nâˆ\nğ‘–\n=\n1\nğ‘˜\nğ‘ \nğ‘–\n ways to add edges to the forest so that it becomes a single tree.\n\nFor each \nğ‘£\nğ‘£\n (\n1â‰¤ğ‘£<ğ‘›\n1\nâ‰¤\nğ‘£\n<\nğ‘›\n), calculate how many of these ways result in a tree \nğ‘‡\nğ‘‡\n satisfying \nğ‘ƒ(ğ‘‡)=ğ‘£\nğ‘ƒ\n(\nğ‘‡\n)\n=\nğ‘£\n.\n\nSince the answers can be large, print them modulo \n998244353\n998\n244\n353\n.",
  "input_format": "Input\n\nEach test contains multiple test cases. The first line contains the number of test cases \nğ‘¡\nğ‘¡\n (\n1â‰¤ğ‘¡â‰¤\n10\n4\n1\nâ‰¤\nğ‘¡\nâ‰¤\n10\n4\n). The description of the test cases follows.\n\nThe first line of each test case contains two integers \nğ‘›\nğ‘›\n and \nğ‘š\nğ‘š\n (\n2â‰¤ğ‘›â‰¤2â‹…\n10\n5\n2\nâ‰¤\nğ‘›\nâ‰¤\n2\nâ‹…\n10\n5\n, \n0â‰¤ğ‘šâ‰¤ğ‘›âˆ’1\n0\nâ‰¤\nğ‘š\nâ‰¤\nğ‘›\nâˆ’\n1\n)Â â€” the number of vertices and edges in the forest, respectively.\n\nThe next \nğ‘š\nğ‘š\n lines of each test case contain two integers \nğ‘¢\nğ‘¢\n and \nğ‘£\nğ‘£\n (\n1â‰¤ğ‘¢,ğ‘£â‰¤ğ‘›,ğ‘¢â‰ ğ‘£\n1\nâ‰¤\nğ‘¢\n,\nğ‘£\nâ‰¤\nğ‘›\n,\nğ‘¢\nâ‰ \nğ‘£\n), describing an edge between vertices \nğ‘¢\nğ‘¢\n and \nğ‘£\nğ‘£\n. It is guaranteed that these edges form a forest (that is, the graph is acyclic).\n\nIt is guaranteed that the sum of \nğ‘›\nğ‘›\n over all test cases does not exceed \n2â‹…\n10\n5\n2\nâ‹…\n10\n5\n.",
  "output_format": "Output\n\nFor each test case, print \nğ‘›âˆ’1\nğ‘›\nâˆ’\n1\n integers on a single line. The \nğ‘–\nğ‘–\n-th integer should be the number of ways to add edges to the forest so that it becomes a tree \nğ‘‡\nğ‘‡\n satisfying \nğ‘ƒ(ğ‘‡)=ğ‘–\nğ‘ƒ\n(\nğ‘‡\n)\n=\nğ‘–\n, modulo \n998244353\n998\n244\n353\n.",
  "constraints": "Note\n\nIn the first example, there are no edges in the forest, and there are \n3\n3\n ways to complete it to a tree. One of them is to add edges \n(1,2)\n(\n1\n,\n2\n)\n and \n(1,3)\n(\n1\n,\n3\n)\n. There are \n2\n2\n leaves: vertex \n2\n2\n and \n3\n3\n. Since \n2\n2\n has a smaller label, it gets deleted from the tree, and only two vertices remain: \n1\n1\n and \n3\n3\n. Therefore, the Prufer vertex of this tree is \n1\n1\n.\n\nIn the third example, the forest is shown below:\n\nSuppose we add edges \n(3,5)\n(\n3\n,\n5\n)\n and \n(3,1)\n(\n3\n,\n1\n)\n to complete it to a tree \nğ‘‡\nğ‘‡\n. It is going to look like this:\n\nIt can be shown that \nğ‘ƒ(ğ‘‡)=1\nğ‘ƒ\n(\nğ‘‡\n)\n=\n1\n.",
  "test_cases": [
    {
      "input": "3\n3 0\n5 4\n4 2\n3 4\n1 2\n4 5\n6 3\n1 6\n6 4\n2 1",
      "output": "1 2 \n0 0 0 1 \n12 0 1 6 5",
      "is_sample": true
    }
  ]
}
