{
  "title": "Prufer Vertex",
  "slug": "cf-2190-D",
  "difficulty": "Hard",
  "tags": [
    "combinatorics",
    "dsu",
    "number theory",
    "probabilities",
    "trees"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "For a tree ğ‘‡ with ğ‘›â‰¥2 vertices, consider the standard process for generating its Prufer sequence. We repeatedly perform the following steps until only two vertices remain:\n\nSelect the leaf with the smallest label;\nRemove it from the tree.\n\nIt is known that vertex ğ‘› is always one of the two remaining vertices. Let ğ‘£ be the other remaining vertex. We define the Prufer vertex of ğ‘‡ as ğ‘ƒ(ğ‘‡)=ğ‘£ğ‘ƒ(ğ‘‡)\n=ğ‘£.\n\nYou are given a forest with ğ‘› vertices and ğ‘š edges. Let ğ‘˜ be the number of connected components in this forest, and let their sizes be ğ‘ 1,ğ‘ 2,â€¦,ğ‘ ğ‘˜. It is known that there are exactly ğ‘›ğ‘˜âˆ’2\nâˆ\nğ‘–=1 ğ‘˜ğ‘ ğ‘–ğ‘›ğ‘˜âˆ’2\nâˆ\nğ‘–=1 ğ‘˜ğ‘ ğ‘– ways to add edges to the forest so that it becomes a single tree.\n\nFor each ğ‘£ (1â‰¤ğ‘£<ğ‘›1â‰¤ğ‘£\n<\nğ‘›), calculate how many of these ways result in a tree ğ‘‡ satisfying ğ‘ƒ(ğ‘‡)=ğ‘£ğ‘ƒ(ğ‘‡)\n=ğ‘£.\n\nSince the answers can be large, print them modulo 998244353.",
  "input_format": "Each test contains multiple test cases. The first line contains the number of test cases ğ‘¡ (1â‰¤ğ‘¡â‰¤10^4). The description of the test cases follows.\n\nThe first line of each test case contains two integers ğ‘› and ğ‘š (2â‰¤ğ‘›â‰¤2â‹…10^5, 0â‰¤ğ‘šâ‰¤ğ‘›âˆ’1)Â â€” the number of vertices and edges in the forest, respectively.\n\nThe next ğ‘š lines of each test case contain two integers ğ‘¢ and ğ‘£ (1â‰¤ğ‘¢,ğ‘£â‰¤ğ‘›,ğ‘¢â‰ ğ‘£1â‰¤ğ‘¢,ğ‘£â‰¤ğ‘›,ğ‘¢â‰ ğ‘£), describing an edge between vertices ğ‘¢ and ğ‘£. It is guaranteed that these edges form a forest (that is, the graph is acyclic).\n\nIt is guaranteed that the sum of ğ‘› over all test cases does not exceed 2â‹…10^5.",
  "output_format": "For each test case, print ğ‘›âˆ’1 integers on a single line. The ğ‘–-th integer should be the number of ways to add edges to the forest so that it becomes a tree ğ‘‡ satisfying ğ‘ƒ(ğ‘‡)=ğ‘–ğ‘ƒ(ğ‘‡)\n=ğ‘–, modulo 998244353.",
  "constraints": "In the first example, there are no edges in the forest, and there are 3 ways to complete it to a tree. One of them is to add edges (1,2)\n and (1,3)\n. There are 2 leaves: vertex 2 and 3. Since 2 has a smaller label, it gets deleted from the tree, and only two vertices remain: 1 and 3. Therefore, the Prufer vertex of this tree is 1.\n\nIn the third example, the forest is shown below:\n\nSuppose we add edges (3,5)\n and (3,1)\n to complete it to a tree ğ‘‡. It is going to look like this:\n\nIt can be shown that ğ‘ƒ(ğ‘‡)=1 ğ‘ƒ(ğ‘‡)\n=1.",
  "test_cases": [
    {
      "input": "3\n3 0\n5 4\n4 2\n3 4\n1 2\n4 5\n6 3\n1 6\n6 4\n2 1",
      "output": "1 2 \n0 0 0 1 \n12 0 1 6 5",
      "is_sample": true
    }
  ],
  "patterns": [
    "dp",
    "union-find",
    "math",
    "dfs"
  ]
}