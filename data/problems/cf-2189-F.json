{
  "title": "Zhora the Vacuum Cleaner",
  "slug": "cf-2189-F",
  "difficulty": "Hard",
  "tags": [
    "data structures",
    "dfs and similar",
    "dp",
    "greedy",
    "implementation",
    "sortings",
    "trees"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "Once upon a time, Zhora the Vacuum Cleaner found a big container with nuts that is represented by a tree with \nğ‘›\nğ‘›\n vertices. Initially, in the \nğ‘–\nğ‘–\n-th vertex, there are \nğ‘\nğ‘–\nğ‘\nğ‘–\n nuts. What Zhora the Vacuum Cleaner likes most is eating nuts, so he decided to eat all the nuts.\n\nTo save electricity, the vacuum cleaner can rearrange the nuts in the container beforehand. Zhora can choose a vertex \nğ‘£\nğ‘£\n of the tree, and for every vertex \nğ‘¢â‰ ğ‘£\nğ‘¢\nâ‰ \nğ‘£\n, in non-increasing order of the length of path \nğ‘¢ğ‘£\nğ‘¢\nğ‘£\n, if \nğ‘¢\nğ‘¢\n contains at least one nut, one nut from \nğ‘¢\nğ‘¢\n moves into the closest vertex to \nğ‘£\nğ‘£\n among \nğ‘¢\nğ‘¢\n's adjacent vertices. This operation requires \nğ‘\nğ‘\n electricity units.\n\nAfter performing several such operations (possibly none), Zhora the Vacuum Cleaner eats all the nuts from every vertex, spending \nğ‘\nğ‘\n electricity units per every vertex that contains nuts.\n\nWhat is the minimum amount of electricity units required to eat all the nuts?",
  "input_format": "Input\n\nEach test contains multiple test cases. The first line contains the number of test cases \nğ‘¡\nğ‘¡\n (\n1â‰¤ğ‘¡â‰¤\n10\n4\n1\nâ‰¤\nğ‘¡\nâ‰¤\n10\n4\n). The description of the test cases follows.\n\nThe first line of each test case contains three integers \nğ‘›\nğ‘›\n, \nğ‘\nğ‘\n, and \nğ‘\nğ‘\n (\n2â‰¤ğ‘›â‰¤\n10\n5\n2\nâ‰¤\nğ‘›\nâ‰¤\n10\n5\n, \n0â‰¤ğ‘,ğ‘â‰¤\n10\n6\n0\nâ‰¤\nğ‘\n,\nğ‘\nâ‰¤\n10\n6\n)Â â€” the number of vertices in the container's tree and the required amounts of electricity for operations of types 1 and 2, respectively.\n\nThe second line of each test case contains \nğ‘›\nğ‘›\n integers \nğ‘\n1\n,\nğ‘\n2\n,â€¦,\nğ‘\nğ‘›\nğ‘\n1\n,\nğ‘\n2\n,\nâ€¦\n,\nğ‘\nğ‘›\n (\n0â‰¤\nğ‘\nğ‘–\nâ‰¤\n10\n6\n0\nâ‰¤\nğ‘\nğ‘–\nâ‰¤\n10\n6\n)Â â€” the quantities of nuts in the vertices.\n\nEach of the next \nğ‘›âˆ’1\nğ‘›\nâˆ’\n1\n lines of each test case contains two integers \nğ‘¢\nğ‘¢\n and \nğ‘£\nğ‘£\n (\n1â‰¤ğ‘¢,ğ‘£â‰¤ğ‘›,ğ‘¢â‰ ğ‘£\n1\nâ‰¤\nğ‘¢\n,\nğ‘£\nâ‰¤\nğ‘›\n,\nğ‘¢\nâ‰ \nğ‘£\n), representing an undirected tree edge from vertex \nğ‘¢\nğ‘¢\n to vertex \nğ‘£\nğ‘£\n. It is guaranteed that the given edges form a tree.\n\nIt is guaranteed that the sum of \nğ‘›\nğ‘›\n over all test cases does not exceed \n10\n5\n10\n5\n.",
  "output_format": "Output\n\nFor each test case, output the minimum amount of electricity units required to eat all the nuts.",
  "constraints": "Note\n\nIn the first test case, it is best to apply the movement operation to vertex \n2\n2\n, and then eat all the \n4\n4\n nuts from vertex \n2\n2\n, spending \n1+1=2\n1\n+\n1\n=\n2\n electricity units in total.\n\nIn the second test case, it is best to apply the movement operation twice to vertex \n3\n3\n, and then eat all the \n5\n5\n nuts from vertex \n3\n3\n, spending \n1+1+100=102\n1\n+\n1\n+\n100\n=\n102\n electricity units in total.\n\nIn the third test case, it is best just to eat all the nuts from vertices \n1,2,4,5\n1\n,\n2\n,\n4\n,\n5\n, spending \n10+10+10+10=40\n10\n+\n10\n+\n10\n+\n10\n=\n40\n electricity units.\n\nIn the fourth test case, it is best to apply the movement operation twice to vertex \n2\n2\n, and then eat all the nuts from vertex \n2\n2\n, spending \n6\n6\n electricity units in total.",
  "test_cases": [
    {
      "input": "6\n4 1 1\n1 1 1 1\n1 2\n2 3\n2 4\n5 1 100\n1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n5 9 10\n4 8 0 8 4\n1 3\n2 3\n3 4\n3 5\n4 1 4\n0 3 1 1\n2 1\n3 1\n4 3\n5 21 93\n0 0 64 4 87\n2 1\n3 1\n4 3\n5 1\n4 5 8\n2 3 0 8\n4 3\n2 3\n3 1",
      "output": "2\n102\n40\n6\n270\n24",
      "is_sample": true
    }
  ]
}
