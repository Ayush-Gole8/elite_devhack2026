{
  "title": "XOR-convenience (Hard Version)",
  "slug": "cf-2189-C2",
  "difficulty": "Medium",
  "tags": [
    "bitmasks",
    "constructive algorithms",
    "math"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "This is the hard version of the problem. The difference between the versions is that in this version, \n1â‰¤ğ‘–â‰¤ğ‘›âˆ’1\n1\nâ‰¤\nğ‘–\nâ‰¤\nğ‘›\nâˆ’\n1\n. Note that a correct solution for the hard version is not necessarily a correct solution for the easy version.\n\nGiven a positive integer \nğ‘›\nğ‘›\n. Find some permutation\nâˆ—\nâˆ—\n \nğ‘\nğ‘\n of length \nğ‘›\nğ‘›\n such that for every \nğ‘–\nğ‘–\n (\n1â‰¤ğ‘–â‰¤ğ‘›âˆ’1\n1\nâ‰¤\nğ‘–\nâ‰¤\nğ‘›\nâˆ’\n1\n) there exists \nğ‘—\nğ‘—\n (\nğ‘–â‰¤ğ‘—â‰¤ğ‘›\nğ‘–\nâ‰¤\nğ‘—\nâ‰¤\nğ‘›\n) such that \nğ‘\nğ‘–\n=\nğ‘\nğ‘—\nâŠ•ğ‘–\nğ‘\nğ‘–\n=\nğ‘\nğ‘—\nâŠ•\nğ‘–\n \nâ€ \nâ€ \n, or determine that it does not exist.\n\nâˆ—\nâˆ—\nA permutation of length \nğ‘›\nğ‘›\n is an array consisting of \nğ‘›\nğ‘›\n distinct integers from \n1\n1\n to \nğ‘›\nğ‘›\n in arbitrary order. For example, \n[2,3,1,5,4]\n[\n2\n,\n3\n,\n1\n,\n5\n,\n4\n]\n is a permutation, but \n[1,2,2]\n[\n1\n,\n2\n,\n2\n]\n is not a permutation (\n2\n2\n appears twice in the array), and \n[1,3,4]\n[\n1\n,\n3\n,\n4\n]\n is also not a permutation (\nğ‘›=3\nğ‘›\n=\n3\n but there is \n4\n4\n in the array).\n\nâ€ \nâ€ \nâŠ•\nâŠ•\n denotes the bitwise XOR operation.",
  "input_format": "Input\n\nEach test contains multiple test cases. The first line contains the number of test cases \nğ‘¡\nğ‘¡\n (\n1â‰¤ğ‘¡â‰¤\n10\n4\n1\nâ‰¤\nğ‘¡\nâ‰¤\n10\n4\n). The description of the test cases follows.\n\nThe only line of each test case contains one positive integer \nğ‘›\nğ‘›\n (\n3â‰¤ğ‘›â‰¤2â‹…\n10\n5\n3\nâ‰¤\nğ‘›\nâ‰¤\n2\nâ‹…\n10\n5\n)Â â€” the length of the permutation.\n\nIt is guaranteed that the sum of \nğ‘›\nğ‘›\n over all test cases does not exceed \n2â‹…\n10\n5\n2\nâ‹…\n10\n5\n.",
  "output_format": "Output\n\nFor each test case, if there is a suitable permutation, output \nğ‘›\nğ‘›\n integers \nğ‘\n1\n,\nğ‘\n2\n,â€¦,\nğ‘\nğ‘›\nğ‘\n1\n,\nğ‘\n2\n,\nâ€¦\n,\nğ‘\nğ‘›\nÂ â€” the permutation \nğ‘\nğ‘\n. Otherwise, output \nâˆ’1\nâˆ’\n1\n.\n\nIf multiple solutions exist, output any of them.",
  "constraints": "Note\n\nIn the first test case, the permutation \nğ‘=[2,1,3]\nğ‘\n=\n[\n2\n,\n1\n,\n3\n]\n fulfills the condition, as \nğ‘\n2\n=1\nğ‘\n2\n=\n1\n and \nğ‘\n3\nâŠ•2=1\nğ‘\n3\nâŠ•\n2\n=\n1\n.\n\nIn the second test case, there is no suitable permutation.",
  "test_cases": [
    {
      "input": "2\n3\n4",
      "output": "2 1 3\n-1",
      "is_sample": true
    }
  ]
}
