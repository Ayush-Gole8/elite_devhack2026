{
  "title": "XOR-convenience (Hard Version)",
  "slug": "cf-2189-C2",
  "difficulty": "Medium",
  "tags": [
    "bitmasks",
    "constructive algorithms",
    "math"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "This is the hard version of the problem. The difference between the versions is that in this version, 1â‰¤ğ‘–â‰¤ğ‘›âˆ’1. Note that a correct solution for the hard version is not necessarily a correct solution for the easy version.\n\nGiven a positive integer ğ‘›. Find some permutation\nâˆ—\nâˆ—\n ğ‘ of length ğ‘› such that for every ğ‘– (1â‰¤ğ‘–â‰¤ğ‘›âˆ’1) there exists ğ‘— (ğ‘–â‰¤ğ‘—â‰¤ğ‘›) such that ğ‘ğ‘–=ğ‘ğ‘—\nâŠ•ğ‘–ğ‘ğ‘–=ğ‘ğ‘—\nâŠ•\nğ‘– â€ \nâ€ \n, or determine that it does not exist.\n\nâˆ—\nâˆ—\nA permutation of length ğ‘› is an array consisting of ğ‘› distinct integers from 1 to ğ‘› in arbitrary order. For example, [2,3,1,5,4]\n[\n2,3,1,5,4\n]\n is a permutation, but [1,2,2]\n[\n1,2,2\n]\n is not a permutation (2 appears twice in the array), and [1,3,4]\n[\n1,3,4\n]\n is also not a permutation (ğ‘›=3 but there is 4 in the array).\n\nâ€ \nâ€ \nâŠ•\nâŠ•\n denotes the bitwise XOR operation.",
  "input_format": "Each test contains multiple test cases. The first line contains the number of test cases ğ‘¡ (1â‰¤ğ‘¡â‰¤10^4). The description of the test cases follows.\n\nThe only line of each test case contains one positive integer ğ‘› (3â‰¤ğ‘›â‰¤2â‹…10^5)Â â€” the length of the permutation.\n\nIt is guaranteed that the sum of ğ‘› over all test cases does not exceed 2â‹…10^5.",
  "output_format": "For each test case, if there is a suitable permutation, output ğ‘› integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›\nÂ â€” the permutation ğ‘. Otherwise, output âˆ’1\nâˆ’1.\n\nIf multiple solutions exist, output any of them.",
  "constraints": "In the first test case, the permutation ğ‘=[2,1,3]\nğ‘=\n[\n2,1,3\n]\n fulfills the condition, as ğ‘2=1 and ğ‘3\nâŠ•2=1 ğ‘3\nâŠ•\n2=1.\n\nIn the second test case, there is no suitable permutation.",
  "test_cases": [
    {
      "input": "2\n3\n4",
      "output": "2 1 3\n-1",
      "is_sample": true
    }
  ],
  "patterns": [
    "bit-manipulation",
    "backtracking",
    "math"
  ]
}