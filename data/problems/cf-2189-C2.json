{
  "title": "XOR-convenience (Hard Version)",
  "slug": "cf-2189-C2",
  "difficulty": "Medium",
  "tags": [
    "bitmasks",
    "constructive algorithms",
    "math"
  ],
  "time_limit_ms": 2000,
  "memory_limit_kb": 256000,
  "description": "This is the hard version of the problem. The difference between the versions is that in this version, 1 â‰¤ ğ‘– â‰¤ ğ‘›-1 1 â‰¤ ğ‘– â‰¤ ğ‘› - 1\n. Note that a correct solution for the hard version is not necessarily a correct solution for the easy version.\n\nGiven a positive integer ğ‘› \n. Find some permutation âˆ— ğ‘ of length ğ‘› such that for every ğ‘– (1 â‰¤ ğ‘– â‰¤ ğ‘›-1 1 â‰¤ ğ‘– â‰¤ ğ‘› - 1) there exists ğ‘— (ğ‘– â‰¤ ğ‘— â‰¤ ğ‘› ğ‘– â‰¤ ğ‘— â‰¤ ğ‘›) such that ğ‘ ğ‘– = ğ‘ ğ‘— âŠ•ğ‘– ğ‘ ğ‘– = ğ‘ ğ‘— âŠ• ğ‘– â€ , or determine that it does not exist. âˆ— A permutation of length ğ‘› \n is an array consisting of ğ‘› \n distinct integers from 1 to ğ‘› in arbitrary order. For example, [2,3,1,5,4] [2, 3, 1, 5, 4] is a permutation, but [1,2,2] [1, 2, 2] is not a permutation (2 \n appears twice in the array), and [1,3,4] [1, 3, 4]\n is also not a permutation (ğ‘›=3 ğ‘› = 3 but there is 4 in the array). â€  âŠ• denotes the bitwise XOR operation.",
  "input_format": "Input\n\nEach test contains multiple test cases. The first line contains the number of test cases ğ‘¡ (1 â‰¤ ğ‘¡ â‰¤ 10 4 1 â‰¤ ğ‘¡ â‰¤ 10 4\n). The description of the test cases follows.\n\nThe only line of each test case contains one positive integer ğ‘› (3 â‰¤ ğ‘› â‰¤ 2â‹… 10 5 3 â‰¤ ğ‘› â‰¤ 2 â‹… 10 5\n)Â â€” the length of the permutation.\n\nIt is guaranteed that the sum of ğ‘› \n over all test cases does not exceed 2â‹… 10 5 2 â‹… 10 5.",
  "output_format": "Output\n\nFor each test case, if there is a suitable permutation, output ğ‘› integers ğ‘ 1, ğ‘ 2,â€¦, ğ‘ ğ‘› ğ‘ 1, ğ‘ 2, â€¦, ğ‘ ğ‘› Â â€” the permutation ğ‘. Otherwise, output -1 - 1. \nIf multiple solutions exist, output any of them.",
  "constraints": "Note\n\nIn the first test case, the permutation ğ‘=[2,1,3] ğ‘ = [2, 1, 3]\n fulfills the condition, as ğ‘ 2 =1 ğ‘ 2 = 1 and ğ‘ 3 âŠ•2=1 ğ‘ 3 âŠ• 2 = 1.\n\nIn the second test case, there is no suitable permutation.",
  "test_cases": [
    {
      "input": "2\n3\n4",
      "output": "2 1 3\n-1",
      "is_sample": true
    }
  ]
}